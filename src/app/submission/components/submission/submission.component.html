
<div class="btn-toolbar mb-4" role="toolbar">
  <div class="btn-group">    
    <button class="btn btn-outline-primary" (click)="onNew()"  >              
        <span class="oi oi-document"></span>
        <span class="ml-2">Nuovo</span>
    </button>    
    <button class="btn btn-outline-primary" [disabled]="!submissionFormDynamic.valid" (click)="onSubmit()" >              
        <span class="oi oi-arrow-top"></span>  
        <span class="ml-2">Aggiorna</span>
    </button>
    <button class="btn btn-outline-primary">
        <span class="oi oi-reload iconic" title="reload" aria-hidden="true"></span>
        <span class="ml-2">Ricarica</span>
    </button>   
    <button class="btn btn-outline-primary">
        <span class="oi oi-trash"></span>
        <span class="ml-2">Rimuovi</span>
      </button>
  </div>
</div>

<form [formGroup]="submissionFormDynamic" (ngSubmit)="register(submissionForm)" accept-charset="UTF-8" class="form-horizontal needs-validation"
id="form-with-validation"> 
<app-dynamic-form *ngIf="false" class="col-md-6 mb-3" [control]="submissionControls.id" [form]="submissionFormDynamic"></app-dynamic-form>
<app-dynamic-form *ngIf="false" class="col-md-6 mb-3" [control]="submissionControls.userId" [form]="submissionFormDynamic"></app-dynamic-form>
<h5>Dati personali</h5>
<div class="form-row">
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.name" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.surname" [form]="submissionFormDynamic"></app-dynamic-form>
</div>

<div class="form-row">
  <app-dynamic-form class="col-md-2 mb-3" [control]="submissionControls.gender" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-4 mb-3" [control]="submissionControls.fiscalcode" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.birthplace" [form]="submissionFormDynamic"></app-dynamic-form>
</div>

<div class="form-row">
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.birthprovince" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.birthdate" [form]="submissionFormDynamic"></app-dynamic-form>  
</div>

<h5>Residenza</h5>
<div class="form-row">
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.com_res" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.prov_res" [form]="submissionFormDynamic"></app-dynamic-form>  
</div>
<div class="form-row">
  <app-dynamic-form class="col-md-4 mb-3" [control]="submissionControls.via_res" [form]="submissionFormDynamic"></app-dynamic-form>
  <app-dynamic-form class="col-md-2 mb-3" [control]="submissionControls.civ_res" [form]="submissionFormDynamic"></app-dynamic-form>  
  <app-dynamic-form class="col-md-6 mb-3" [control]="submissionControls.presso" [form]="submissionFormDynamic"></app-dynamic-form>
</div>

<div class="mt-4">
  <app-assignment [controls]="assignmetControls" [form]="submissionFormDynamic" [control]="submissionControls.assignments" ></app-assignment>
</div>

<div class="mt-4">
    <ng-template #assignment let-controls="controls" let-item="item">      
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.role" [form]="item"></app-dynamic-form>          
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.title" [form]="item"></app-dynamic-form>             
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.istitute" [form]="item"></app-dynamic-form>                 
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.from" [form]="item"></app-dynamic-form>               
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.to" [form]="item"></app-dynamic-form>           
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.document" [form]="item"></app-dynamic-form> 
         </td>
         <td>
           <app-dynamic-form class="col-md-4 mb-3" [control]="controls.path" [form]="item"></app-dynamic-form>               
         </td>              
     </ng-template>

  <app-control-generic-list [controls]="assignmetControls" [form]="submissionFormDynamic" [control]="submissionControls.assignments" [itemTemplate]="assignment">
  </app-control-generic-list> 
  
</div>

<!-- <div class="mt-4">
  <h5>{{ submissionControls.assignments.label }}</h5>
  
  <div class="btn-toolbar mb-4" role="toolbar">
      <div class="btn-group">    
        <button class="btn btn-outline-primary" (click)="addAssignment()"  >              
            <span class="oi oi-plus"></span>
            <span class="ml-2">Aggiungi</span>
        </button>    
        <button class="btn btn-outline-primary" [disabled]="!submissionFormDynamic.valid" >              
            <span class="oi oi-trash"></span>  
            <span class="ml-2">Rimuovi</span>
        </button>
      </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead> </thead>
      <tbody formArrayName="{{ submissionControls.assignments.key }}">
        <tr *ngFor="let assignmentDynamic of submissionFormDynamic.get('assignments').controls; let i = index;">
          <div [formGroupName]="i">  
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.role" [form]="assignmentDynamic"></app-dynamic-form>          
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.title" [form]="assignmentDynamic"></app-dynamic-form>             
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.istitute" [form]="assignmentDynamic"></app-dynamic-form>                 
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.from" [form]="assignmentDynamic"></app-dynamic-form>               
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.to" [form]="assignmentDynamic"></app-dynamic-form>           
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.document" [form]="assignmentDynamic"></app-dynamic-form> 
            </td>
            <td>
              <app-dynamic-form class="col-md-4 mb-3" [control]="assignmetControls.path" [form]="assignmentDynamic"></app-dynamic-form>               
            </td>
          </div>
        </tr>
      </tbody>
    </table>
  </div>
</div> -->

<p>Form value: {{ submissionFormDynamic.value | json }}</p>
<p>Form status: {{ submissionFormDynamic.status | json }}</p>
</form> 

<app-message class="mb-4"></app-message>

